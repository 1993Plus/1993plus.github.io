<!DOCTYPE html>


  <html class="light page-post">


<head>
  <meta charset="utf-8">
  
  <title>systemd 基础应用 | Weidong</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="systemd," />
  

  <meta name="description" content="systemd 从 CentOS7.x 以后，RedHat 系列的 distrbution 放弃了沿用多年的 System V 开机启动服务的流程，改用 systemd 服务管理机制。 systemd 的特性  平行处理所有服务，加速开机流程；旧的 init 启动脚本是一项一项任务依次启动模式，因此不相依的服务也是要一个一个的等待。而 systemd 可以让所有服务同时启动，加快系统启动速度。 按">
<meta name="keywords" content="systemd">
<meta property="og:type" content="article">
<meta property="og:title" content="systemd 基础应用">
<meta property="og:url" content="http://www.weidong.io/2017/09/15/systemd-basic-opt/index.html">
<meta property="og:site_name" content="Weidong">
<meta property="og:description" content="systemd 从 CentOS7.x 以后，RedHat 系列的 distrbution 放弃了沿用多年的 System V 开机启动服务的流程，改用 systemd 服务管理机制。 systemd 的特性  平行处理所有服务，加速开机流程；旧的 init 启动脚本是一项一项任务依次启动模式，因此不相依的服务也是要一个一个的等待。而 systemd 可以让所有服务同时启动，加快系统启动速度。 按">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2017-09-15T09:43:53.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="systemd 基础应用">
<meta name="twitter:description" content="systemd 从 CentOS7.x 以后，RedHat 系列的 distrbution 放弃了沿用多年的 System V 开机启动服务的流程，改用 systemd 服务管理机制。 systemd 的特性  平行处理所有服务，加速开机流程；旧的 init 启动脚本是一项一项任务依次启动模式，因此不相依的服务也是要一个一个的等待。而 systemd 可以让所有服务同时启动，加快系统启动速度。 按">

  

  
    <link rel="icon" href="/favicon.ico">
  

  <link href="/css/styles.css?v=c114cbe6" rel="stylesheet">


  
    <link rel="stylesheet" href="/css/personal-style.css">
  

  

  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?57e94d016e201fba3603a8a2b0263af0";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


  
  <script type="text/javascript">
	(function(){
	    var bp = document.createElement('script');
	    var curProtocol = window.location.protocol.split(':')[0];
	    if (curProtocol === 'https') {
	        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
	    }
	    else {
	        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
	    }
	    var s = document.getElementsByTagName("script")[0];
	    s.parentNode.insertBefore(bp, s);
	})();
  </script>



  
    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  

  
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">
  
</head>

<body>


  
    <span id="toolbox-mobile" class="toolbox-mobile">盒子</span>
  

  <div class="post-header CENTER">
   
  <div class="toolbox">
    <a class="toolbox-entry" href="/">
      <span class="toolbox-entry-text">盒子</span>
      <i class="icon-angle-down"></i>
      <i class="icon-home"></i>
    </a>
    <ul class="list-toolbox">
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/archives/"
            rel="noopener noreferrer"
            target="_self"
            >
            博客
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/category/"
            rel="noopener noreferrer"
            target="_self"
            >
            分类
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/tag/"
            rel="noopener noreferrer"
            target="_self"
            >
            标签
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/link/"
            rel="noopener noreferrer"
            target="_self"
            >
            友链
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/about/"
            rel="noopener noreferrer"
            target="_self"
            >
            关于
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/search/"
            rel="noopener noreferrer"
            target="_self"
            >
            搜索
          </a>
        </li>
      
    </ul>
  </div>


</div>




<div class="content content-post CENTER">
   <article id="post-systemd-basic-opt" class="article article-type-post" itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">systemd 基础应用</h1>

    <div class="article-meta">
      <span>
        <i class="icon-calendar"></i>
        <span>2017.09.15</span>
      </span>

      
        <span class="article-author">
          <i class="icon-user"></i>
          <span>Weidong</span>
        </span>
      

      
  <span class="article-category">
    <i class="icon-list"></i>
    <a class="article-category-link" href="/categories/Linux/">Linux</a>
  </span>



      
        <span>
          <i class="icon-comment"></i>
          <a href="http://www.weidong.io/2017/09/15/systemd-basic-opt/#disqus_thread"></a>
        </span>
      

      
      <i class="fa fa-eye"></i> 
        <span id="busuanzi_container_page_pv">
           &nbsp热度 <span id="busuanzi_value_page_pv">
           <i class="fa fa-spinner fa-spin"></i></span>℃
        </span>
      

      
      
    </div>
  </header>

  <div class="article-content">
    
      <p><strong>systemd</strong></p>
<p>从 CentOS7.x 以后，RedHat 系列的 distrbution 放弃了沿用多年的 System V 开机启动服务的流程，改用 systemd 服务管理机制。</p>
<p><strong>systemd 的特性</strong></p>
<ul>
<li>平行处理所有服务，加速开机流程；旧的 init 启动脚本是一项一项任务依次启动模式，因此不相依的服务也是要一个一个的等待。而 systemd 可以让所有服务同时启动，加快系统启动速度。</li>
<li>按需启动模式；仅有 systemd 服务搭配 systemctl 命令来处理，无须其他额外的命令来支持，所有服务都采用非独立模式，由 systemd 来负责监听服务端口，当监听到服务端口有请求时 systemd 才会将任务交给 daemon。</li>
<li>服务相依性检查；systemd 可以自动对服务进行相依性检查，如果 A 服务是依赖于 B 服务的，如果在没有启动 B 服务的情况下启动 A 服务，systemd 会自动启动 B 服务。</li>
<li>根据 daemon 功能分类；systemd 定义了所有的服务为一个服务单位（unit），并将该 unit 归类到不同的服务类型（type）中。systemd 将 unit 区分为 service、socket、target、path、snapshot、timer 等多种不同的类型（type）。</li>
<li>将多个 daemons 集合成为一个群组；systemd 将许多的功能集合成为一个 target 项目，这个项目主要负责操作环境的创建，执行某个 target 就是执行了很多 daemons。</li>
<li>向下兼容 init 服务脚本；systemd 是可以兼容 init 的启动脚本的，所以就得 init 启动脚本也能通过 systemd 来管理，只是一些高级的 systemd 功能不支持。</li>
<li>在 runlevel 的对应上；大概仅有 runlevel 1、3、5 有对应的 systemd target 类型。</li>
<li>全部的 systemd 都用 systemctl 来管理；而 systemctl 所支持的语法有限制，systemctl 不可以自定参数。</li>
<li>如果某个服务是手动执行启动的，而不是使用 systemctl 启动的，那么 systemd 将无法侦测到该服务，所以不能使用 systemctl 对其进行管理。</li>
<li>systemd 启动过程中无法与管理员通过 standard input（标准输入）进行互动。</li>
</ul>
<p><strong>systemd 的配置文件存放目录</strong></p>
<p>systemd 将过去的 daemon 执行脚本通通称为一个服务单位（unit），而每种服务单位依据功能来区分时就分为不同的类型（type）。基本的类型有系统服务、监听与交换数据的 socket 服务、存储系统状态的快照类型、提供不同类型的操作环境（target）等，这些配置文件都存放在以下目录中；</p>
<ul>
<li>/usr/lib/systemd/system/：每个服务最主要的启动脚本设置，类似以前的 /etc/init.d 下面的文件</li>
<li>/run/systemd/system/：系统执行过程中所产生的服务脚本，这些脚本的优先等级比 /usr/lib/systemd/system/ 高</li>
<li>/etc/systemd/system/：管理员根据需求所创建的执行脚本，优先等级最高，其实在这个目录中存放的都是些链接文件，而实际都是存放在 /usr/lib/systemd/system/ 下面的。</li>
</ul>
<p><strong>systemd 的 unit 类型分类</strong></p>
<p>在 /usr/lib/systemd/system/ 中有很多执行脚本，区分不同的类型主要看扩展名。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># ll /usr/lib/systemd/system/ | grep '\(crond\|multi\)'</span></div><div class="line">-rw-r--r--. 1 root root  284 Mar 31  2016 crond.service</div><div class="line">-rw-r--r--. 1 root root  492 May 26 05:22 multi-user.target</div><div class="line">drwxr-xr-x. 2 root root  279 Aug 15 17:40 multi-user.target.wants</div><div class="line">lrwxrwxrwx. 1 root root   17 Aug 15 17:40 runlevel2.target -&gt; multi-user.target</div><div class="line">lrwxrwxrwx. 1 root root   17 Aug 15 17:40 runlevel3.target -&gt; multi-user.target</div><div class="line">lrwxrwxrwx. 1 root root   17 Aug 15 17:40 runlevel4.target -&gt; multi-user.target</div></pre></td></tr></table></figure>
<ul>
<li>.service；一般服务类型，系统服务与服务器本身所需要的本机服务以及网络服务等</li>
<li>.socket；内部程序数据交换的 socket 服务，当有请求通过 socket 传递信息来需要连接服务时，就根据当时的状态将该用户的请求传送到对应的 daemon，若 daemon 未启动，则启动该 daemon 后再传送用户的请求</li>
<li>.target；执行环节类型，其实就是一堆 unit 的集合，当执行一个 target 就是执行一堆其他 .service 或者 .socket 之类的服务</li>
<li>.mount/.automount；文件系统挂载相关的服务（mount unit/automount unit）</li>
<li>.path；侦测特定文件或目录类型（path unit），某些服务需要侦测某些特定的目录来听过伫列服务，比如打印服务</li>
<li>.timer；循环执行的服务（timer unit）</li>
</ul>
<blockquote>
<p>其中 .service 类型的最常见，因为一堆网络服务都是通过这种类型来设计的</p>
</blockquote>
<p><strong>使用 systemctl 管理单一服务（service unit）</strong></p>
<p>命令使用格式</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">systemctl [OPTIONS...] &#123;UNIT&#125; ...</div></pre></td></tr></table></figure>
<p>命令常用选项</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">start			<span class="comment">## 启动目标 unit</span></div><div class="line">stop			<span class="comment">## 停止目标 unit</span></div><div class="line">restart			<span class="comment">## 重启目标 unit(先执行 stop 再执行 start)</span></div><div class="line">reload			<span class="comment">## 在不停止目标 unit 的情况下重新载入配置文件让设置生效</span></div><div class="line"><span class="built_in">enable</span>			<span class="comment">## 设置目标 unit 在系统开机时自动启动</span></div><div class="line"><span class="built_in">disable</span>			<span class="comment">## 设置目标 unit 在系统开机时不自动启动</span></div><div class="line">status			<span class="comment">## 查看目标 unit 当前状态</span></div><div class="line">is-active		<span class="comment">## 查看目标 unit 是否在运行</span></div><div class="line">is-enabled		<span class="comment">## 查看目标 unit 开机是否启动</span></div><div class="line">static			<span class="comment">## 设置目标 unit 禁止自启动，但可以被其他依赖的服务启动</span></div><div class="line">mask			<span class="comment">## 设置目标 unit 禁止启动，此时目标 unit 的启动脚本会被链接到 /dev/null</span></div><div class="line"><span class="built_in">umask</span>			<span class="comment">## 取消目标 unit 的禁止启动</span></div></pre></td></tr></table></figure>
<p>示例</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="comment">## 使用 status 查看 atd 服务状态</span></div><div class="line">[root@localhost ~]<span class="comment"># systemctl status atd.service</span></div><div class="line">● atd.service - Job spooling tools</div><div class="line">   Loaded: loaded (/usr/lib/systemd/system/atd.service; enabled; vendor preset: enabled)</div><div class="line">   Active: active (running) since Sun 2017-09-10 17:38:41 CST; 1min 44s ago</div><div class="line"> Main PID: 5781 (atd)</div><div class="line">   CGroup: /system.slice/atd.service</div><div class="line">           └─5781 /usr/sbin/atd -f</div><div class="line"></div><div class="line">Sep 10 17:38:41 localhost systemd[1]: Started Job spooling tools.</div><div class="line">Sep 10 17:38:41 localhost systemd[1]: Starting Job spooling tools...</div><div class="line"><span class="comment">## 使用 stop 停止 atd 服务</span></div><div class="line">[root@localhost ~]<span class="comment"># systemctl stop atd.service</span></div><div class="line"><span class="comment">## 使用 start 启动 atd 服务</span></div><div class="line">[root@localhost ~]<span class="comment"># systemctl start atd.service</span></div><div class="line"><span class="comment">## 使用 restart 重启 atd 服务</span></div><div class="line">[root@localhost ~]<span class="comment"># systemctl restart atd.service</span></div><div class="line"><span class="comment">## 使用 disable 禁止 atd 服务开机自动启动</span></div><div class="line">[root@localhost ~]<span class="comment"># systemctl disable atd.service</span></div><div class="line">Removed symlink /etc/systemd/system/multi-user.target.wants/atd.service.</div><div class="line"><span class="comment">## 使用 enable 将 atd 服务设置为开机自动启动</span></div><div class="line">[root@localhost ~]<span class="comment"># systemctl enable atd.service</span></div><div class="line">Created symlink from /etc/systemd/system/multi-user.target.wants/atd.service to /usr/lib/systemd/system/atd.service.</div><div class="line"><span class="comment">## 使用 is-active 查看 atd 服务是否在运行中</span></div><div class="line">[root@localhost ~]<span class="comment"># systemctl is-active atd.service</span></div><div class="line">active</div><div class="line"><span class="comment">## 使用 is-enabled 查看 atd 服务是否为开机自启动</span></div><div class="line">[root@localhost ~]<span class="comment"># systemctl is-enabled atd.service</span></div><div class="line">enabled</div><div class="line"><span class="comment">## 使用 mask 将 atd 服务设置为禁止启动 </span></div><div class="line">[root@localhost ~]<span class="comment"># systemctl mask atd.service</span></div><div class="line">Created symlink from /etc/systemd/system/atd.service to /dev/null.</div><div class="line"><span class="comment">## 再次重启 atd 服务</span></div><div class="line">[root@localhost ~]<span class="comment"># systemctl restart atd.service</span></div><div class="line">Failed to restart atd.service: Unit is masked.</div><div class="line"><span class="comment">## 取消 atd 服务的 mask 设置</span></div><div class="line">[root@localhost ~]<span class="comment"># systemctl unmask atd.service</span></div><div class="line">Removed symlink /etc/systemd/system/atd.service.</div></pre></td></tr></table></figure>
<p><strong>使用 systemctl 观察系统中的所有服务</strong></p>
<p>常用选项</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">list-units		<span class="comment">## 列出当前已启动的 unit 使用 --all 查看包括未启动的 unit</span></div><div class="line">list-unit-files	<span class="comment">## 根据 /usr/lib/systemd/system 中的文件列出 unit 列表</span></div><div class="line">--<span class="built_in">type</span>=TYPE		<span class="comment">## 查看指定类型的 unit，如 service、socket、target 等</span></div><div class="line"></div><div class="line"><span class="comment">## 其实直接使用 systemctl 就是查看所有已启动的 unit</span></div></pre></td></tr></table></figure>
<p><strong>使用 systemctl 管理 target unit</strong></p>
<p>查看当前已有的 target unit</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># systemctl list-units --type=target --all</span></div><div class="line">  UNIT                   LOAD      ACTIVE   SUB    DESCRIPTION</div><div class="line">  basic.target           loaded    active   active Basic System</div><div class="line">  bluetooth.target       loaded    inactive dead   Bluetooth</div><div class="line">  cryptsetup.target      loaded    active   active Encrypted Volumes</div><div class="line">  emergency.target       loaded    inactive dead   Emergency Mode</div><div class="line">  final.target           loaded    inactive dead   Final Step</div><div class="line">  getty.target           loaded    active   active Login Prompts</div><div class="line">  graphical.target       loaded    inactive dead   Graphical Interface</div><div class="line">  <span class="built_in">local</span>-fs-pre.target    loaded    active   active Local File Systems (Pre)</div><div class="line">  <span class="built_in">local</span>-fs.target        loaded    active   active Local File Systems</div><div class="line">  multi-user.target      loaded    active   active Multi-User System</div><div class="line">  network-online.target  loaded    active   active Network is Online</div><div class="line">  network-pre.target     loaded    inactive dead   Network (Pre)</div><div class="line">  network.target         loaded    active   active Network</div><div class="line">  nfs-client.target      loaded    active   active NFS client services</div><div class="line">  nss-lookup.target      loaded    inactive dead   Host and Network Name Lookups</div><div class="line">  nss-user-lookup.target loaded    inactive dead   User and Group Name Lookups</div><div class="line">  paths.target           loaded    active   active Paths</div><div class="line">  remote-fs-pre.target   loaded    active   active Remote File Systems (Pre)</div><div class="line">  remote-fs.target       loaded    active   active Remote File Systems</div><div class="line">  rescue.target          loaded    inactive dead   Rescue Mode</div><div class="line">  rpcbind.target         loaded    inactive dead   RPC Port Mapper</div><div class="line">  shutdown.target        loaded    inactive dead   Shutdown</div><div class="line">  slices.target          loaded    active   active Slices</div><div class="line">  sockets.target         loaded    active   active Sockets</div><div class="line">  swap.target            loaded    active   active Swap</div><div class="line">  sysinit.target         loaded    active   active System Initialization</div><div class="line">● syslog.target          not-found inactive dead   syslog.target</div><div class="line">  time-sync.target       loaded    inactive dead   System Time Synchronized</div><div class="line">  timers.target          loaded    active   active Timers</div><div class="line">  umount.target          loaded    inactive dead   Unmount All Filesystems</div><div class="line"></div><div class="line">LOAD   = Reflects whether the unit definition was properly loaded.</div><div class="line">ACTIVE = The high-level unit activation state, i.e. generalization of SUB.</div><div class="line">SUB    = The low-level unit activation state, values depend on unit <span class="built_in">type</span>.</div><div class="line"></div><div class="line">30 loaded units listed.</div><div class="line">To show all installed unit files use <span class="string">'systemctl list-unit-files'</span>.</div></pre></td></tr></table></figure>
<p><strong>与操作环境相关的 target</strong></p>
<ul>
<li>multi-user.target；纯文本模式</li>
<li>graphical.target；文字加图形界面，其中包含了 multi.user.target</li>
<li>rescue.target；救援模式，这是一个额外的系统，如果需要操作原有的系统需要使用 chroot 的方式来切换到原有系统</li>
<li>emergency.target;紧急救援模式，需要使用 root 用户登录，在无法使用 rescue.target 时可以尝试该模式</li>
<li>shutdown.target；关机模式</li>
<li>gettty.target；设置可登录的 tty 数量</li>
<li>​</li>
</ul>
<p>获取当前默认 target</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># systemctl get-default</span></div><div class="line">multi-user.target</div></pre></td></tr></table></figure>
<p>设置默认 target</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># systemctl set-default graphical.target </span></div><div class="line">Removed symlink /etc/systemd/system/default.target.</div><div class="line">Created symlink from /etc/systemd/system/default.target to /usr/lib/systemd/system/graphical.target.</div><div class="line">[root@localhost ~]<span class="comment">#</span></div></pre></td></tr></table></figure>
<p>临时切换 target</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]<span class="comment"># systemctl isolate graphical.target </span></div><div class="line"><span class="comment">## 如果当前系统中有安装图形服务那系统就会开启图形界面</span></div></pre></td></tr></table></figure>
<p>使用 systemctl 分析各服务之间的依赖关系</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="comment">## 使用 list-dependencies 查看所有 unit 的依赖关系</span></div><div class="line">[root@localhost ~]<span class="comment"># systemctl list-dependencies </span></div><div class="line">default.target</div><div class="line">● ├─auditd.service</div><div class="line">● ├─brandbot.path</div><div class="line">● ├─chronyd.service</div><div class="line">● ├─crond.service</div><div class="line">● ├─dbus.service</div><div class="line">● ├─irqbalance.service</div><div class="line">● ├─mdmonitor.service</div><div class="line">● ├─network.service</div><div class="line">● ├─NetworkManager.service</div><div class="line">● ├─plymouth-quit-wait.service</div><div class="line">● ├─plymouth-quit.service</div><div class="line">● ├─postfix.service</div><div class="line">● ├─rsyslog.service</div><div class="line">● ├─sshd.service</div><div class="line">● ├─systemd-ask-password-wall.path</div><div class="line">● ├─systemd-logind.service</div><div class="line">● ├─systemd-readahead-collect.service</div><div class="line">● ├─systemd-readahead-replay.service</div><div class="line">● ├─systemd-update-utmp-runlevel.service</div><div class="line">● ├─systemd-user-sessions.service</div><div class="line">● ├─tuned.service</div><div class="line">● ├─vmtoolsd.service</div><div class="line">● ├─basic.target</div><div class="line">...略...</div><div class="line"></div><div class="line"><span class="comment">## 使用 --reverse 反向追踪</span></div><div class="line">[root@localhost ~]<span class="comment"># systemctl list-dependencies sshd.service --reverse</span></div><div class="line">sshd.service</div><div class="line">● └─multi-user.target</div><div class="line">●   └─graphical.target</div></pre></td></tr></table></figure>
<p>END!</p>

    
  </div>
</article>


   

   
  <div class="box-prev-next clearfix">
    <a class="show pull-left" href="/2017/09/13/uninstall-nodejs-md/">
        <i class="icon icon-angle-left"></i>
    </a>
    <a class="show pull-right" href="/2017/09/15/parted/">
        <i class="icon icon-angle-right"></i>
    </a>
  </div>




</div>


  <a id="backTop" class="back-top">
    <i class="icon-angle-up"></i>
  </a>




  <div class="modal" id="modal">
  <span id="cover" class="cover hide"></span>
  <div id="modal-dialog" class="modal-dialog hide-dialog">
    <div class="modal-header">
      <span id="close" class="btn-close">关闭</span>
    </div>
    <hr>
    <div class="modal-body">
      <ul class="list-toolbox">
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/archives/"
              rel="noopener noreferrer"
              target="_self"
              >
              博客
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/category/"
              rel="noopener noreferrer"
              target="_self"
              >
              分类
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/tag/"
              rel="noopener noreferrer"
              target="_self"
              >
              标签
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/link/"
              rel="noopener noreferrer"
              target="_self"
              >
              友链
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/about/"
              rel="noopener noreferrer"
              target="_self"
              >
              关于
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/search/"
              rel="noopener noreferrer"
              target="_self"
              >
              搜索
            </a>
          </li>
        
      </ul>

    </div>
  </div>
</div>



  
      <div class="fexo-comments comments-post">
    
  <section class="disqus-comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
  </section>

  <script>
    var disqus_shortname = 'forsigner';
    
    var disqus_url = 'http://www.weidong.io/2017/09/15/systemd-basic-opt/';
    
    (function(){
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>

  <script id="dsq-count-scr" src="//forsigner.disqus.com/count.js" async></script>



    




    

    
	
  </div>

  

  <script type="text/javascript">
  function loadScript(url, callback) {
    var script = document.createElement('script')
    script.type = 'text/javascript';

    if (script.readyState) { //IE
      script.onreadystatechange = function() {
        if (script.readyState == 'loaded' ||
          script.readyState == 'complete') {
          script.onreadystatechange = null;
          callback();
        }
      };
    } else { //Others
      script.onload = function() {
        callback();
      };
    }

    script.src = url;
    document.getElementsByTagName('head')[0].appendChild(script);
  }

  window.onload = function() {
    loadScript('/js/bundle.js?235683', function() {
      // load success
    });
  }
</script>

</body>
</html>
